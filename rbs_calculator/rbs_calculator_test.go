package rbs_calculator

var eColi16SrRNA string = Organism16SrRNAMap["Escherichia coli str. K-12 substr. DH10B"]

// run with `go test -run ^ExampleRibosomeBindingSites | less -S`. Piping to
// `less -S` allows you to view the complete horizontal output (use the left
// and right arrow keys to scroll horizontally)
func ExampleRibosomeBindingSites() {
	startCodons := []StartCodon{AUG, GUG}
	mRNA := "UCUAGAGGCCGACGCAAGCCCAUAUCGGGGCUUCCGUCGGCCAUAAGGAGGUAAAAAAUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUCAUGCGUUUCAAAGUUCGUAUGGAAGGUUCCGUUAACGGUCACGAGUUCGAAAUCGAAGGUGAAGGUGAA"
	ribosomeBindingSites := RibosomeBindingSites(eColi16SrRNA, mRNA, 37.0, startCodons)
	includeSequences, includeStructures := true, true
	PrintBindingSites(ribosomeBindingSites, includeSequences, includeStructures)

	// Output:
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
	// | Start position | Start codon |        TIR         |                                        5' Untranslated Region                                        |       Protein Coding Sequence       |                                                              Initial state                                                              |                                  Final state (pre ribosome)                                  |    Final state (mRNA shine     |                     Final state (spacing)                      |     Final state (ribosome      | Final state (post ribosome) |  Final state (16S rRNA shine   |
	// |                |             |                    |                                                                                                      |                                     |                                                                                                                                         |                                                                                              |     dalgarno binding site)     |                                                                |           footprint)           |                             |     dalgarno binding site)     |
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
	// |             57 | AUG         | 1371.7379800494562 | UCUAGAGGCCGACGCAAGCCCAUAUCGGGGCUUCCGUCGGCCAUAAGGAGGUAAAAA                                            | AUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUCAU | (((...((((((((.((((((......)))))).))))))))...)))..............(((((((...((.....))..)))))))..                                            | ......((((((((.((((((......)))))).)))))))).                                                  | (((((((((.                     | ......                                                         | .............                  | ......................      | &)))))))))                     |
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
	// |             90 | AUG         |  371.0747870285378 | UCUAGAGGCCGACGCAAGCCCAUAUCGGGGCUUCCGUCGGCCAUAAGGAGGUAAAAAAUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUC           | AUGCGUUUCAAAGUUCGUAUGGAAGGUUCCGUUAA | (((...((((((((.((((((......)))))).))))))))...)))............(((((((.((.((((((...............)))))))).)))))))(((((....)))))...           | (((...((((((((.((((((......)))))).))))))))...))).........((((((...((....))))))))....         | .....(((..                     | ....                                                           | .............                  | .....(((((....)))))...      | &..)))....                     |
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
	// |            108 | AUG         |  686.5874771259898 | CCGACGCAAGCCCAUAUCGGGGCUUCCGUCGGCCAUAAGGAGGUAAAAAAUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUCAUGCGUUUCAAAGUUCGU | AUGGAAGGUUCCGUUAACGGUCACGAGUUCGAAAU | ((((((.((((((......)))))).))))))....................(((((((((...((.....))..)))))))..))(((((((.(((((((((((....)))))..))))..))...)).))))) | ((((((.((((((......)))))).))))))...............(((((..(((((((...((.....))..)))))))...))))).. | ...(((....                     | ..............                                                 | .............                  | ......................      | &.....))).                     |
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
	// |            148 | GUG         |   90.0399665401908 | AGGUAAAAAAUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUCAUGCGUUUCAAAGUUCGUAUGGAAGGUUCCGUUAACGGUCACGAGUUCGAAAUCGAAG | GUGAAGGUGAA                         | ............(((((((.((.((((((...............)))))))).)))))))(((((....)))))..((..((((...((((....)))).))))..))...                         | ............(((((((.((((.((((...............)))))))).)))))))(((((....)))))...........        | ((........                     | .............................................................. | .............                  |                             | &..)).....                     |
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
	// |            154 | GUG         | 22343.342774740442 | AAAAUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUCAUGCGUUUCAAAGUUCGUAUGGAAGGUUCCGUUAACGGUCACGAGUUCGAAAUCGAAGGUGAAG | GUGAA                               | ......(((((((.((((.((((...............)))))))).)))))))(((((....)))))..((..((((...((((....)))).))))..))...                               | ...((..((((((((((...(((((.(......((((((((..........)))))))).......).))))).))).)))))))..)).   | .(.((((...                     | ...........................................................    | .............                  |                             | &)))).)...                     |
	// +----------------+-------------+--------------------+------------------------------------------------------------------------------------------------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------+--------------------------------+-----------------------------+--------------------------------+
}

func ExampleRibosomeBindingSites_WithPropertiesPrint() {
	startCodons := []StartCodon{AUG, GUG}
	mRNA := "UCUAGAGGCCGACGCAAGCCCAUAUCGGGGCUUCCGUCGGCCAUAAGGAGGUAAAAAAUGGCGAGCUCUGAAGACGUUAUCAAAGAGUUCAUGCGUUUCAAAGUUCGUAUGGAAGGUUCCGUUAACGGUCACGAGUUCGAAAUCGAAGGUGAAGGUGAA"
	ribosomeBindingSites := RibosomeBindingSites(eColi16SrRNA, mRNA, 37.0, startCodons)

	propertiesToPrint := []string{"dG_total", "dG_standby", "dG_mRNA_rRNA", "dG_spacing", "dG_start", "dG_mRNA"}
	includeSequences, includeStructures := false, false
	PrintBindingSites(ribosomeBindingSites, includeSequences, includeStructures, propertiesToPrint...)

	// Output:
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
	// | Start position | Start codon |        TIR         |       dG_total       |     dG_standby      |    dG_mRNA_rRNA     |       dG_spacing       | dG_start | dG_mRNA |
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
	// |             57 | AUG         | 11406.326932378308 | -0.23695180054918197 |  7.8344000000000005 | -36.471351800549186 |                      0 |    -2.76 |  -31.16 |
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
	// |             90 | AUG         |  9758.641990326309 |   2.6684486190675116 |  1.0898000000000003 |  -33.05135138093249 | 1.9315212836132985e-22 |    -2.76 |  -37.39 |
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
	// |            108 | AUG         | 10502.152668976929 |   1.3010485805970546 |  0.7224000000000004 | -28.551351421463643 | 2.06069436060075e-09   |    -2.76 |  -31.89 |
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
	// |            148 | GUG         |   8241.35548298349 |    5.815448574960078 | 0.21680000000000277 | -16.521351425039924 |                   5.04 |    -0.42 |   -17.5 |
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
	// |            154 | GUG         | 15913.233952723489 |   -6.437951533520376 |   4.293400000000001 | -28.711351533520375 | 3.4922694633892816e-19 |    -0.42 |   -18.4 |
	// +----------------+-------------+--------------------+----------------------+---------------------+---------------------+------------------------+----------+---------+
}
